{{ define "content" }}
<h2>Добавить тур</h2>

<form id="createTourForm" action="/tours" method="POST">
    <label>Название:</label><br>
    <input type="text" id="name" name="name" required><br><br>

    <label>Рейтинг:</label><br>
    <input type="text" id="rating" name="rating"><br><br>

    <label>Отель:</label><br>
    <input type="text" id="hotel" name="hotel"><br><br>

    <label>Питание:</label><br>
    <input type="text" id="nutrition" name="nutrition"><br><br>

    <label>Город:</label><br>
    <input type="text" id="city" name="city"><br><br>

    <label>Страна:</label><br>
    <input type="text" id="country" name="country"><br><br>

    <label>Цена за единицу:</label><br>
    <input type="text" id="price" name="price"><br><br>

    <label>Провайдер:</label><br>
    <select id="provider" name="provider" required>
        <option value="">-- Выберите провайдера --</option>
        {{ range .Providers }}
        <option value="{{ .ID }}">{{ .Name }}</option>
        {{ end }}
    </select><br><br>

    <button type="submit">Создать</button>
</form>

<script>
    document.getElementById("createTourForm").addEventListener("submit", async function(e) {
        e.preventDefault();
    
        const tour = {
            name: document.getElementById("name").value,
            rating: document.getElementById("rating").value,
            hotel: document.getElementById("hotel").value,
            nutrition: document.getElementById("nutrition").value,
            city: document.getElementById("city").value,
            country: document.getElementById("country").value,
            provider: document.getElementById("provider").value,
            price: document.getElementById("price").value
        };
    
        const res = await fetch(`/tours/new`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(tour)
        });
    
        if (res.ok) {
            alert("Тур создан");
            window.location.href = "/tours";
        } else {
            const data = await res.json();
            alert(data.error || "Ошибка");
        }
    });
</script>
{{ end }}

{{ template "base.html" }}
